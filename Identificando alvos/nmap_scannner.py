#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# nmap_scanner.py

"""
  Este arquivo utiliza a biblioteca nmap para realizar varreduras de portas.
"""

import sys
try:
    import nmap
except ImportError:
    sys.exit("[!] Instale a biblioteca nmap com o comando: pip install python-nmap")

def scan_ports(target, ports):
    scanner = nmap.PortScanner()

    try:
        scanner.scan(target, ports)
    except nmap.PortScannerError as e:
        sys.exit(f"[!] Ocorreu um erro na varredura: {str(e)}")

    print("Portas fornecidas:", ports)
    print("Hosts encontrados:", scanner.all_hosts())

    for host in scanner.all_hosts():
        for port in ports.split(','):
            port_state = scanner[host]['tcp'][int(port)]['state']
            print(f"[*] {host} tcp/{port} {port_state}")

# Validação de argumentos
if len(sys.argv) != 3:
    sys.exit("Forneça dois argumentos, sendo o primeiro o alvo e o segundo as portas")

target = sys.argv[1]
ports = sys.argv[2]

scan_ports(target, ports)






